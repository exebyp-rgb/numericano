---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { ingredients } from "@/lib/data";
import { chartSlugs, chartByIngredient } from "@/lib/site-data";

const chartToIngredient = Object.fromEntries(
  Object.entries(chartByIngredient).map(([ingredient, chart]) => [chart, ingredient])
);

const charts = chartSlugs
  .map((slug) => {
    const ingredientSlug = chartToIngredient[slug];
    const ingredient = ingredients.find((item) => item.slug === ingredientSlug);
    return ingredient
      ? {
          slug,
          name: ingredient.name,
          href: `/charts/${slug}/`,
          ingredientHref: `/ingredients/${ingredient.slug}/`,
        }
      : null;
  })
  .filter(Boolean);

const title = "Cooking conversion charts";
const description = "Print-friendly conversion charts for popular ingredients.";
---

<BaseLayout title={title} description={description}>
  <section class="card card-pad">
    <p class="text-sm uppercase tracking-wider text-slate-500">Charts</p>
    <h1 class="text-2xl font-bold text-slate-900">Cooking conversion charts</h1>
    <p class="text-slate-600 mt-2">Quick reference tables you can print or bookmark.</p>
  </section>

  <section class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 mt-6">
    {charts.map((chart) => (
      <article class="card hover:shadow-md transition">
        <div class="card-pad">
          <h2 class="text-lg font-semibold text-slate-900">
            <a href={chart.href}>{chart.name} chart</a>
          </h2>
          <p class="text-sm text-slate-600 mt-1">
            Ingredient: <a class="text-primary-600" href={chart.ingredientHref}>{chart.name}</a>
          </p>
          <div class="mt-3">
            <a class="btn" href={chart.href}>Open chart</a>
          </div>
        </div>
      </article>
    ))}
  </section>
</BaseLayout>
